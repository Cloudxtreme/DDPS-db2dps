#
# INI style configuration file for db2dps
#

[db]

dbuser 				= postgres
dbpassword			= hopsasa
dbname				= netflow

# Production:
# newrules 	= select flowspecruleid, direction, destinationprefix, sourceprefix, ipprotocol, srcordestport, destinationport, sourceport, icmptype, icmpcode, tcpflags, packetlength, dscp, fragmentencoding from flow.flowspecrules, flow.fastnetmoninstances where flow.flowspecrules.fastnetmoninstanceid = flow.fastnetmoninstances.fastnetmoninstanceid AND not isactivated AND mode = 'enforce';

newrules 			= select flowspecruleid, direction, destinationprefix, sourceprefix, ipprotocol, srcordestport, destinationport, sourceport, icmptype, icmpcode, tcpflags, packetlength, dscp, fragmentencoding from flow.flowspecrules, flow.fastnetmoninstances

all_rules 			= select flowspecruleid, direction, destinationprefix, sourceprefix, ipprotocol, srcordestport, destinationport, sourceport, icmptype, icmpcode, tcpflags, packetlength, dscp, fragmentencoding from flow.flowspecrules, flow.fastnetmoninstances

remove_expired_rules = select flowspecruleid, direction, destinationprefix, sourceprefix, ipprotocol, srcordestport, destinationport, sourceport, icmptype, icmpcode, tcpflags, packetlength, dscp, fragmentencoding from flow.flowspecrules, flow.fastnetmoninstances where flow.flowspecrules.fastnetmoninstanceid = flow.fastnetmoninstances.fastnetmoninstanceid AND isactivated AND not isexpired AND ( mode = 'enforce' AND now() >= validto OR mode = 'detect');

[ssh]

hostlist			= "localhost fodhost"
exabgp_pipe			= "/tmp/exabgp_cmds"
identity_file		= "/home/rnd/.ssh/id_rsa"
sshuser	= "rnd"

[general]
# store semaphore files (hostnames/ip addresses) here
datadir				= /opt/db2dps/data

shutdown			= /tmp/.shutdown_now

[flowspec]
#tcpudpdrop			= announce flow route %dst { match { source any destination %dst destination-port %dport proto %ipproto; } then { discard; } } }
#icmpdrop			= announce flow route %dst { match { protocol icmp; } then { log; discard; } } }
#ipdrop				= missing info for discarding %ipproto
#blackhole			= missing info here for black hole of %dst
#ratelimit			= missing info here for ratelimit of %dst

tcpudpdrop			= announce flow route %s { match { source any destination %s destination-port %s proto %s; } then { discard; } } }
icmpdrop			= announce flow route %s { match { protocol icmp; } then { log; discard; } } }
ipdrop				= missing info for discarding %s
blackhole			= missing info here for black hole of %s
ratelimit			= missing info here for ratelimit of %s
